# 🔥 Flutter Web 热重载完整配置指南

## ✅ 已完成的配置

### 1. VS Code 设置优化 (`.vscode/settings.json`)
```json
{
    // 自动保存设置
    "files.autoSave": "afterDelay",         // 延迟2秒自动保存
    "files.autoSaveDelay": 2000,
    
    // Flutter热重载核心设置  
    "dart.flutterHotReloadOnSave": "all",   // 保存时自动热重载
    "dart.previewFlutterUiGuides": true,    // 启用UI辅助线
    
    // 代码格式化
    "editor.formatOnSave": true,            // 保存时自动格式化
    "dart.lineLength": 100,                 // 代码行长度限制
    
    // 性能优化
    "dart.debugExternalPackageLibraries": false,  // 不调试外部包
    "dart.debugSdkLibraries": false,              // 不调试SDK库
}
```

### 2. 启动配置 (`.vscode/launch.json`)
提供了6种不同的启动模式：

- **🌐 Flutter Web (热重载启用)** - 默认推荐配置
- **🌐 Flutter Web (Web服务器模式)** - 适合多浏览器测试  
- **🚫 Flutter Web (热重载禁用)** - 调试时使用
- **📱 Flutter Debug (所有平台)** - 通用调试模式
- **🏃 Flutter Profile Mode** - 性能分析模式
- **🚀 Flutter Release Mode** - 发布模式测试
- **🔧 Flutter Web + CORS代理** - 集成CORS代理

### 3. 任务配置 (`.vscode/tasks.json`)
自动化任务：
- 启动/停止CORS代理服务器
- 环境健康检查  
- Flutter清理和依赖获取
- Web构建任务

### 4. 推荐插件 (`.vscode/extensions.json`)
- Dart-Code.dart-code (Dart语言支持)
- Dart-Code.flutter (Flutter支持)
- usernamehw.errorlens (错误高亮)
- esbenp.prettier-vscode (代码格式化)

### 5. 代码片段 (`.vscode/snippets.code-snippets`)
- `stless` - StatelessWidget模板
- `stful` - StatefulWidget模板  
- `responsive` - 响应式布局模板
- `consumer` - Provider Consumer模板

## 🚀 使用指南

### 快速开始
1. **打开VS Code** 
2. **选择启动配置**: `🌐 Flutter Web (热重载启用)`
3. **按F5启动** 或点击调试面板的运行按钮
4. **开始编码**, 保存文件时自动热重载

### 热重载快捷键
- **热重载**: `Ctrl+F5` (Mac: `Cmd+F5`)
- **热重启**: `Ctrl+Shift+F5` (Mac: `Cmd+Shift+F5`)
- **停止调试**: `Shift+F5`

### 命令面板操作 (Ctrl+Shift+P)
- `Flutter: Hot Reload` - 手动热重载
- `Flutter: Hot Restart` - 手动热重启
- `Flutter: Select Device` - 选择目标设备
- `Tasks: Run Task` - 运行自定义任务

## 🔧 高级配置

### 环境变量设置
项目支持以下环境变量：
- `USE_PROXY=true` - 启用CORS代理模式
- `NODE_ENV=development` - 设置开发环境

### 自动化工作流
1. **启动时自动运行代理** - 选择"🔧 Flutter Web + CORS代理"配置
2. **保存时自动格式化** - 已在settings.json中启用
3. **自动依赖检查** - 运行"环境健康检查"任务

## 🐛 故障排除

### 热重载不工作？
1. **检查VS Code输出面板** - 查看Dart和Flutter日志
2. **尝试热重启** - 按`Ctrl+Shift+F5`
3. **重启调试会话** - 停止后重新启动
4. **检查代码错误** - 确保没有语法错误

### 常见问题解决
```bash
# 清理Flutter缓存
flutter clean && flutter pub get

# 重启VS Code Dart Language Server  
# Ctrl+Shift+P -> "Dart: Restart Analysis Server"

# 检查Flutter Doctor
flutter doctor
```

### 性能优化建议
- 避免频繁修改`main()`函数和全局变量
- 使用`const`构造函数而非`final`
- 将UI修改集中在`build()`方法内
- 对于复杂修改，优先使用热重启

## 🎯 最佳实践

### 代码结构优化
```dart
// ✅ 推荐: 可热重载的代码结构
class MyWidget extends StatelessWidget {
  const MyWidget({Key? key}) : super(key: key);
  
  @override
  Widget build(BuildContext context) {
    return Container(
      color: Colors.blue,  // 修改这里可以热重载
      child: Text('Hello'),
    );
  }
}

// ❌ 避免: 需要热重启的修改
final globalData = [1, 2, 3];  // 修改初始值需要热重启
```

### 开发工作流
1. **保存文件** → 自动热重载 (2秒内生效)
2. **查看效果** → 浏览器自动刷新
3. **调试问题** → 使用DevTools (F12)
4. **重大修改** → 使用热重启 (`Ctrl+Shift+F5`)

## 📊 配置验证

运行健康检查脚本验证配置：
```bash
./scripts/health_check.sh
```

检查项目包括：
- ✅ VS Code配置文件完整性
- ✅ Flutter和Dart环境
- ✅ 热重载功能可用性
- ✅ 代理服务器状态
- ✅ 端口占用情况

---

**配置完成！** 🎉 现在你拥有了一个完全优化的Flutter Web热重载开发环境。